"use strict";(self.webpackChunknama_document_sim=self.webpackChunknama_document_sim||[]).push([[172],{2172:(e,t,a)=>{a.r(t),a.d(t,{nama_log_viz:()=>r});var h=a(729),s=a(7549);const r=class{constructor(e){(0,h.r)(this,e),this.graph=null,this.peer=void 0}handleOnChange(e){if(this.peer!==e.detail.peer)return;const t=e.detail.operations;for(const e of t)this.peer===e.authorName()&&this.addNode(e.authorName(),e.hash(),e.seqNum());for(const e of t)this.peer===e.authorName()&&this.addEdge(e.hash(),e.backlink());this.prune(e.detail.pruned),this.layout()}addNode(e,t,a){0===this.graph.$(`#${t}`).length&&this.graph.add({group:"nodes",grabbable:!1,data:{label:`${e}_${a}`,id:t,isNew:!0},style:{"background-color":s.g[a%s.g.length]}})}addEdge(e,t){const a=this.graph.$(`#${e}`),h=this.graph.$(`#${t}`);0!==a.length&&0!==h.length&&0===a.edgesWith(h).length&&this.graph.add({group:"edges",data:{source:t,target:e}})}prune(e){for(const t of e){if(0===this.graph.$(`#${t}`).length)continue;const e=this.graph.$(`#${t}`);this.graph.remove(e)}}layout(){this.graph.layout({name:"dagre",animate:!0,fit:!0,nodeDimensionsIncludeLabels:!0,animateFilter:function(e,t){return!e.data().isNew||(e.data("isNew",!1),!1)}}).run()}componentDidLoad(){let e=this.el.shadowRoot.querySelector("#log");this.graph=(0,s.i)(e)}render(){return(0,h.h)("div",{key:"47e246d12e8efad8b976339c573286da4d3729a9",id:"log"})}get el(){return(0,h.g)(this)}};r.style=":host{display:block}#log{height:100%;width:100%}"}}]);